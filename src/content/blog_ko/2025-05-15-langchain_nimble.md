---
title: Pythonì—ì„œì˜ LangChain Nimble ì‚¬ìš© ì˜ˆ
slug: langchain_nimble
description: Nimble Retrieverê°€ LangChainì— í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤. Pythonì—ì„œ Nimble Retrieverë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.
date: 2025-05-15T04:01:16.002Z
preview: https://b.rmc-8.com/img/2025/05/15/2ec7f029f7700300b626a9c0293c80a6.jpg
draft: false
tags: ['LangChain', 'Python', 'LangGraph']
categories: ['Programming']
---

# Pythonì—ì„œì˜ LangChain Nimble ì‚¬ìš© ì˜ˆ

Nimble Retrieverê°€ LangChainì— í†µí•©ë˜ì—ˆë‹¤ê³  í•˜ì—¬, ê·¸ ë‚´ìš©ì´ ì˜ ì´í•´ê°€ ë˜ì§€ ì•Šì•„ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ê²€ì¦í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">ğŸŒğŸ” Nimble Retriever Integration<br><br>Introducing a powerful web data retriever that brings precise and accurate data fetching to LangChain-powered LLM applications, seamlessly integrating into the retriever ecosystem.<br><br>Learn more here ğŸ‘‰ <a href="https://t.co/eqGwHq4lmL">https://t.co/eqGwHq4lmL</a> <a href="https://t.co/Aco1VztvAV">pic.twitter.com/Aco1VztvAV</a></p>&mdash; LangChain (@LangChainAI) <a href="https://twitter.com/LangChainAI/status/1921279069812891781?ref_src=twsrc%5Etfw">May 10, 2025</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ã€Nimble Retrieverê°€ LangChainì— í†µí•©ã€‘<br><br>ì›¹ ë°ì´í„°ë¥¼ ì •í™•í•˜ê³  ì •ë°€í•˜ê²Œ ìˆ˜ì§‘í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” Nimble Retrieverê°€ LangChainì— í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ í†µí•©ìœ¼ë¡œ LangChainì„ í™œìš©í•œ LLM ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ Nimble Retrieverì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>Nimbleâ€¦ <a href="https://t.co/RM5bWxwScO">pic.twitter.com/RM5bWxwScO</a></p>&mdash; LangChainJP (@LangChainJP) <a href="https://twitter.com/LangChainJP/status/1922578068427669504?ref_src=twsrc%5Etfw">May 14, 2025</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

## Langchain Nimbleì´ë€

ì´ë²ˆì— LangChainì— í†µí•©ëœ Nimbleì€ ì›¹ìƒì˜ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  ì½˜í…ì¸  ì¶”ì¶œì— íŠ¹í™”ëœ AIë¥¼ íƒ‘ì¬í•œ ì›¹ ìŠ¤í¬ë˜í•‘ í”Œë«í¼ì…ë‹ˆë‹¤. ì›¹ í˜ì´ì§€ì˜ HTML êµ¬ì¡°ëŠ” ë‹¤ì–‘í•˜ë©°, ë˜í•œ ë´‡ì— ì˜í•œ í¬ë¡¤ë§ì´ ë°©ì§€ëœ ì‚¬ì´íŠ¸ë„ ìˆìŠµë‹ˆë‹¤. êµ¬ì¡°í™”ëœ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” ë° ì´ ë‹¤ì–‘ì„±ê³¼ ë´‡ ë°©ì§€ ì¡°ì¹˜ê°€ ì–´ë ¤ì›€ì„ ì´ˆë˜í•©ë‹ˆë‹¤. Nimbleì€ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ì—¬ ì›¹ í˜ì´ì§€ì—ì„œ ì½˜í…ì¸ ë¥¼ ì •í™•í•˜ê³  ê¹¨ë—í•˜ê²Œ ì¶”ì¶œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ ê¸°ëŠ¥ì´ WebAPIë¡œ ì œê³µë©ë‹ˆë‹¤. ì´ë²ˆ LangChain í†µí•©ìœ¼ë¡œ LangChainì˜ ì¼ë°˜ì ì¸ ì‚¬ìš© ë°©ì‹ì— ë”°ë¼ Nimbleì˜ WebAPIë¥¼ ì´ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìœ¼ë©°, LangChainì˜ `langchain_core.documents.base.Document[source]` í˜•ì‹ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì‚¬ìš© ë°©ë²•

Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì œê³µë˜ë©°, pip ë“±ìœ¼ë¡œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
pip install -U langchain-nimble
```

ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•œ í›„ [Nimbleì˜ ì›¹ í˜ì´ì§€](https://app.nimbleway.com/login)ì—ì„œ ê³„ì •ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. ì´ë©”ì¼ ì£¼ì†Œê°€ Gmail ë“± ë¬´ë£Œ ì„œë¹„ìŠ¤ì¸ ê²½ìš° ë“±ë¡ì´ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•˜ì„¸ìš”. ê³„ì •ì„ ë§Œë“  í›„ API ì‚¬ìš©ì„ ìœ„í•œ ì¤€ë¹„ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ í›„ ì™¼ìª½ ì‚¬ì´ë“œ ë©”ë‰´ì˜ 'Pipelines'ë¥¼ í´ë¦­í•œ ë‹¤ìŒ 'NimbleAPI'ë¥¼ í´ë¦­í•©ë‹ˆë‹¤. Username & Password ì•„ë˜ì— 3ê°œì˜ í…ìŠ¤íŠ¸ ë°•ìŠ¤ê°€ ìˆì§€ë§Œ, ê·¸ ì¤‘ ê°€ì¥ ì˜¤ë¥¸ìª½ì— ìˆëŠ” 'Base64 token'ì´ LangChain Nimbleì—ì„œ ì‚¬ìš©í•  API í‚¤ì…ë‹ˆë‹¤.

ì´ API í‚¤ë¥¼ ë³µì‚¬í•˜ì—¬ í™˜ê²½ ë³€ìˆ˜ `NIMBLE_API_KEY`ì˜ ê°’ì— ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”. Windows ë“±ì˜ ê²½ìš° í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•œ í›„ ì¬ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. Macì´ë‚˜ Linuxì˜ ê²½ìš° source ëª…ë ¹ì–´ ë˜ëŠ” export ë“±ì„ ì‚¬ìš©í•˜ì—¬ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ ì£¼ì„¸ìš”.

## ì‚¬ìš© ì˜ˆ

[GitHub](https://github.com/rmc8/langchain_nimble_practice)ì— ìƒ˜í”Œ ì½”ë“œë¥¼ ê²Œì‹œí–ˆìŠµë‹ˆë‹¤. ë¦¬í¬ì§€í† ë¦¬ë¥¼ í´ë¡ í•œ í›„ `uv sync`ë¥¼ ì‹¤í–‰í•˜ë©´ ì‹¤í–‰ í™˜ê²½ì„ ë°”ë¡œ ë§Œë“¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ê·¸ í›„ `uv run main.py -q "{ì¡°ì‚¬í•˜ê³  ì‹¶ì€ ë‚´ìš©}" -k {ì°¸ì¡°í•  ë¬¸ì„œ ìˆ˜ë¥¼ ì •ìˆ˜ë¡œ ì…ë ¥(Optional)}`ë¡œ CLIë¥¼ í†µí•´ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì½”ë“œ ì „ì²´

```py
import pathlib
import logging
import tomllib
from typing_extensions import Any, TypedDict

import fire
from langchain_core.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI
from langchain_nimble import NimbleSearchRetriever
from langgraph.graph import START, END, StateGraph
from pydantic import BaseModel, Field


logger = logging.getLogger(__name__)


class SummaryData(BaseModel):
    summary: str = Field(
        ...,
        description="å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è¦ç´„ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’æ ¼ç´ã™ã‚‹ã€‚",
    )


class State(TypedDict):
    query: str
    k: int
    docs: list[str]
    summary: str
    config: dict[str, Any]


def get_config() -> dict[str, Any]:
    this_dir = pathlib.Path(__file__).parent
    config_file = this_dir / "config.toml"
    with config_file.open("rb") as f:
        return tomllib.load(f)


def retrieve(state: State) -> dict[str, Any]:
    """ã‚¯ã‚¨ãƒªã«åŸºã¥ã„ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ã—ã€é–¢é€£ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒªã‚¹ãƒˆå½¢å¼ã§è¿”ã™é–¢æ•°ã€‚NimbleSearchRetrieverã‚’ä½¿ç”¨ã€‚"""
    retriever = NimbleSearchRetriever(k=state["k"])
    example_docs = retriever.invoke(state["query"])
    doc_list: list[str] = [doc.page_content for doc in example_docs]
    return {"docs": doc_list}


def summarize(state: State) -> dict[str, Any]:
    """ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã‚’è¦ç´„ã™ã‚‹é–¢æ•°ã€‚ChatPromptTemplateã¨ChatOpenAIã‚’ä½¿ç”¨ã—ã¦è¦ç´„ã‚’ç”Ÿæˆã€‚"""
    prompt = ChatPromptTemplate.from_template(
        template=state["config"]["summarize"]["prompt"]
    )
    llm = ChatOpenAI(model_name=state["config"]["summarize"]["model"])
    chain = prompt | llm.with_structured_output(SummaryData)
    context = "\n\n".join(doc for doc in state["docs"])
    logger.debug(context)
    res: SummaryData = chain.invoke({"context": context})
    return {"summary": res.summary}


def proc(q: str, k: int = 5):
    """æŒ‡å®šã•ã‚ŒãŸã‚¯ã‚¨ãƒªã¨kå€¤ã§å‡¦ç†ã‚’å®Ÿè¡Œã—ã€è¦ç´„ã‚’å–å¾—ã™ã‚‹é–¢æ•°ã€‚kãŒæ­£ã®æ•´æ•°ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã€‚"""
    if not isinstance(k, int) or k < 1:
        raise ValueError("kã¯1ä»¥ä¸Šã®æ•´æ•°ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚")
    # graphã‚’ä½œã‚‹
    graph_builder = StateGraph(State)
    # Nodeã‚’è¿½åŠ ã™ã‚‹
    graph_builder.add_node("retrieve", retrieve)
    graph_builder.add_node("summarize", summarize)
    # Edgeã‚’è¿½åŠ ã™ã‚‹
    graph_builder.add_edge(START, "retrieve")
    graph_builder.add_edge("retrieve", "summarize")
    graph_builder.add_edge("summarize", END)
    # Compile
    app = graph_builder.compile()
    # appã‚’å®Ÿè¡Œã™ã‚‹
    state: State = {
        "query": q,
        "k": k,
        "docs": [],
        "summary": "",
        "config": get_config(),
    }
    res = app.invoke(state)
    # çµæœã‚’å‡ºåŠ›ã™ã‚‹
    logger.info(res["summary"])


def main():
    fire.Fire(proc)


if __name__ == "__main__":
    logging.basicConfig(level=logging.INFO)
    main()
```

### ì„¤ëª…

ê°„ë‹¨í•œ LangChain, LangGraphë¥¼ ì‚¬ìš©í•œ ì²˜ë¦¬ íë¦„ì„ êµ¬ì„±í•˜ê³  ìˆìœ¼ë©°, Langchain Nimbleë¡œ ë¬¸ì„œë¥¼ ì¶”ì¶œí•˜ê³ , OpenAIì˜ `gpt-4.1-nano`ë¡œ ìˆ˜ì§‘í•œ ë¬¸ì„œë¥¼ ëª¨ìˆœ ì—†ì´ ìš”ì•½í•˜ëŠ” ì§€ì‹œë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ëª¨ë¸ê³¼ í”„ë¡¬í”„íŠ¸ëŠ” ì™¸ë¶€ì˜ `config.toml`ì— ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•©ë‹ˆë‹¤.

```toml
[summarize]
model = "gpt-4.1-nano"
prompt = """
ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’20ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ä»¥å†…ã«ã‹ã¤çŸ›ç›¾ç”Ÿã˜ãªã„ã‚ˆã†ã«ã—ã¦è¦ç´„ã—ã¦ãã ã•ã„ã€‚

Context:
{context}
"""
```

OpenAIì˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê³  ìˆì§€ë§Œ Nimbleê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì •ì˜í•´ì•¼ í•˜ë©°, `OPENAI_API_KEY`ì— API í‚¤ë¥¼ ì„¤ì •í•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤. Nimbleì˜ ì²˜ë¦¬ëŠ” ê°„ë‹¨í•˜ë©°, NimbleSearchRetrieverì— ë¬¸ì„œë¥¼ ì–¼ë§ˆë‚˜ ìˆ˜ì§‘í• ì§€ ì–‘ì˜ ì •ìˆ˜ ê°’ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤. ê·¸ í›„ retrieverë¡œ Langchainì˜ ìµìˆ™í•œ invoke ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰í•˜ê³  ì‹¶ì€ ë‚´ìš©ì„ ë¬¸ìì—´ë¡œ ì œê³µí•˜ë©´ Nimble ì¸¡ì—ì„œ ìŠ¤í¬ë˜í•‘ì„ ìˆ˜í–‰í•˜ê³ , Langchainì˜ Document ëª©ë¡ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```py
def retrieve(state: State) -> dict[str, Any]:
    """ã‚¯ã‚¨ãƒªã«åŸºã¥ã„ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ã—ã€é–¢é€£ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒªã‚¹ãƒˆå½¢å¼ã§è¿”ã™é–¢æ•°ã€‚NimbleSearchRetrieverã‚’ä½¿ç”¨ã€‚"""
    retriever = NimbleSearchRetriever(k=state["k"])
    example_docs = retriever.invoke(state["query"])
    doc_list: list[str] = [doc.page_content for doc in example_docs]
    return {"docs": doc_list}
```

ê·¸ í›„, ìˆ˜ì§‘í•œ ë¬¸ì„œë¥¼ ìš”ì•½í•˜ê±°ë‚˜, ë¬¸ì„œ ê¸°ë°˜ì˜ ì •ë³´ë§Œìœ¼ë¡œ ë‹µë³€(RAG), ê´€ë ¨ ì •ë³´ë¥¼ ë™ì ìœ¼ë¡œ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ ì¶”ê°€ ê²€ìƒ‰í•˜ëŠ” ë“±ì˜ ë°œì „ì ì¸ ì²˜ë¦¬ë¥¼ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. LangChainë§Œìœ¼ë¡œë„ ìš”ì•½ì´ë‚˜ RAGëŠ” ì¶©ë¶„íˆ ê°€ëŠ¥í•˜ì§€ë§Œ, ë™ì  ê²€ìƒ‰ì´ë‚˜ ë°˜ë³µ ì²˜ë¦¬ì˜ íŒë‹¨ì´ í¬í•¨ëœ ë³µì¡í•œ ì›Œí¬í”Œë¡œë¥¼ êµ¬ì¶•í•˜ëŠ” ê²½ìš° LangGraphë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì¢‹ì„ ê²ƒì…ë‹ˆë‹¤.

## ìš”ì•½

Nimbleì„ ì‚¬ìš©í•˜ë©´ ê²€ìƒ‰ê³¼ ìŠ¤í¬ë˜í•‘ì„ ë†’ì€ ì •í™•ë„ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ê²€ìƒ‰ ê´€ë ¨ ì˜¤ë¥˜ ë°œìƒë¥ ì„ ë‚®ì¶œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì¿¼ë¦¬ë¥¼ í†µí•´ ë¬¸ì„œë¥¼ ì¶”ì¶œí•˜ëŠ” ì ˆì°¨ëŠ” ê°„ë‹¨í•˜ë¯€ë¡œ, RAGë‚˜ DeepResearchì˜ ìì‘ ë“± ê°œë°œì—ì„œì˜ ë†€ì´ í­ì´ ë„“ì–´ì§ˆ ê²ƒì…ë‹ˆë‹¤. LangChainì˜ ì‚¬ìš©ê°ì— ë§ì¶° ì‰½ê²Œ Nimbleì„ ì‹œí—˜í•´ ë³¼ ìˆ˜ ìˆìœ¼ë‹ˆ, ê¼­ ì‹œë„í•´ ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤!