---
import type { GetStaticPaths } from "astro";
import type { CollectionEntry } from "astro:content";
import { getCollection } from "astro:content";
import Layout from "@/layouts/Base.astro";
import Article from "@/components/blog/Article.astro";
import { getRelatedPosts } from "@/lib/collections/related";

interface Props {
    singleBlog: CollectionEntry<"blog_en">;
}

export const getStaticPaths: GetStaticPaths = async () => {
    const allBlogs = await getCollection("blog_en");
    const pathData = allBlogs.map((singleBlog) => ({
        params: {
            slug: singleBlog.slug,
        },
        props: {
            singleBlog: singleBlog,
        },
    }));
    return pathData;
};

const LANG_CODE = "en";
const { singleBlog } = Astro.props;
const { Content, headings } = await singleBlog.render();
const allBlogs = await getCollection("blog_en");
const relatedPosts = getRelatedPosts(singleBlog, allBlogs, 6);
---

<Layout
    title=`${singleBlog.data.title} - Scriptone`
    }
    description={singleBlog.data.description}
>
    <Article
        LANG_CODE={LANG_CODE}
        Content={Content}
        headings={headings}
        singleBlog={singleBlog}
        relatedPosts={relatedPosts}
    />
</Layout>
